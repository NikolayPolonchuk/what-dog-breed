# Определение породы собаки по фото

Полончук Николай Андреевич

## Постановка задачи
Цель проекта – разработать модель машинного обучения для распознавания породы собак по фотографии собаки. Модель может быть использована для застенчивых любителей собак, которые очень хотят узнать породу понравившейся на улице собаки, но боятся подойти и прямо спросить.

### Формат входных и выходных данных
Входные данные: фотографии собак в формате .jpg, 120 различных пород, до препроцессинга имеют разные размеры, после препроцессинга размер будет 224 на 224 для стандартов ImageNet. 

Выходные данные: вектор вероятностей длины 120, пользователь будет получать наиболее вероятную породу.

### Метрики
Буду использовать Accuracy, ожидаю параметр в пределах 0.80-0.95, т.к. ошибки в схожих породах наверняка будут.

### Валидация и тест
Разделение данных - 90% train и 10% validation. Фиксируем seed для воспроизводимости, чтобы другие исследователи имели возможность повторить эксперимент и получить те же результаты. Так же это важно для честного сравнения разных методов на одинаковых данных и условиях.

### Датасеты
Источник: https://www.kaggle.com/competitions/dog-breed-identification/data.
Kaggle: Dog Breed Identification
Характеристики датасета: 20581 файл, общий вес 715МБ
Дисбаланс классов присутствует, но он мал: самая редкая порода имеет 66 фото, а самая распространённая – 126.

## Моделирование

### Бейзлайн
Небольшая свёрточная модель, обученная с нуля. Сможем сравнить насколько важно предобучение текущей модели.

### Основная модель
Основнaя модель - предобученная на ImageNet ViT-L-16. Будем использовать трансферное обучение, то есть заменим головку классификации, заморозим все параметры и дообучим на датасете.
https://docs.pytorch.org/vision/main/models/generated/torchvision.models.vit_l_16.html


### Внедрение
Интересно было бы сделать телеграмм-бота, чтобы можно было отправить фотографию собаки и он выдавал наиболее вероятную породу.

## Setup




```
# 0) Клонировать репозиторий
git clone  https://github.com/NikolayPolonchuk/what-dog-breed

# 0.5) Установить uv (если ещё не установлен)
# pip install uv

# 1) Установить зависимости
uv sync

# 2) Проверка кодстайла
uv run pre-commit install
uv run pre-commit run -a

# 3) Скачивание данных с Kaggle и DVC
uv run python -m paddy_disease.commands download_data

# 4) Обучение
uv run python -m paddy_disease.commands train train.epochs=1 data.batch_size=8 data.num_workers=0

# 5) Экспорт ONNX
uv run python -m paddy_disease.commands export_onnx

# 6) Экспорт labels (индекс -> имя класса, нужно для инференса)
uv run python -m paddy_disease.commands export_labels

# 7) Triton в Docker
sudo docker compose up -d triton
curl -sf http://localhost:8000/v2/health/ready >/dev/null && echo "READY"


```